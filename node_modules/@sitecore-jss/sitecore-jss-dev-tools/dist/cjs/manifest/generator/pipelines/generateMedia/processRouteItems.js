"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const traversal_1 = require("../../traversal");
const utils_1 = require("./utils");
exports.default = (args) => {
    const { routes } = args;
    const templates = (0, utils_1.enhanceTemplates)(args.templates);
    const media = args.media ? [...args.media] : [];
    (0, traversal_1.traverseItems)(routes, (item) => {
        const routeMedia = (0, utils_1.buildMediaOutput)(item, templates);
        media.push(...routeMedia);
        if (item.layout && item.layout.renderings) {
            item.layout.renderings.forEach((rendering) => {
                const dataSourceMedia = (0, utils_1.buildMediaOutput)(rendering.dataSource, templates);
                media.push(...dataSourceMedia);
            });
        }
    });
    return Object.assign(Object.assign({}, args), { media });
};
